USE [SIC]
GO

CREATE TABLE CONFIRMAFACILOCORRENCIA (
  ID                  INT NOT NULL IDENTITY PRIMARY KEY,
  CONFIRMAFACIL_ID    INT NOT NULL,
  OCORRENCIA_ID       INT NOT NULL,
  OCORRENCIA_NOME     VARCHAR(60),
  OCORRENCIA_DATA     DATETIME NOT NULL,
  OCORRENCIA_OBS      VARCHAR(2000),
  RECEBEDOR_DOC       VARCHAR(40),
  RECEBEDOR_NOME      VARCHAR(60),
  DT_CREATE           DATETIME DEFAULT CURRENT_TIMESTAMP,
  DT_SEND             DATETIME,
  RESPOSTA_MSG        VARCHAR(2000),
  RESPOSTA_STATUS     INT,
  RESPOSTA_PROTOCOLO  VARCHAR(60),
  CdEmpresa           INT,
  NrSeqControle       BIGINT,
  CdSequencia         INT,
  FLAG_SEND           INT NOT NULL DEFAULT 0,
  VER_ID              INT NOT NULL DEFAULT 1
);

CREATE INDEX IDX_CONFIRMAFACILOCORRENCIA_ID         ON CONFIRMAFACILOCORRENCIA (CONFIRMAFACIL_ID);
CREATE INDEX IDX_CONFIRMAFACILOCORRENCIA_SEND       ON CONFIRMAFACILOCORRENCIA (FLAG_SEND,DT_CREATE);
CREATE INDEX IDX_CONFIRMAFACILOCORRENCIA_SENIOR     ON CONFIRMAFACILOCORRENCIA (CdEmpresa,NrSeqControle,CdSequencia);

ALTER TABLE CONFIRMAFACILOCORRENCIA ADD CONSTRAINT FK_CONFIRMAFACILOCORRENCIA_ID 
FOREIGN KEY (CONFIRMAFACIL_ID) REFERENCES CONFIRMAFACIL(ID);

-- 31/08/2021 14:53
-- ALTER TABLE CONFIRMAFACILOCORRENCIA ADD OCORRENCIA_OBS VARCHAR(2000) NULL;

-- 01/09/2021 14:53
-- ALTER TABLE CONFIRMAFACILOCORRENCIA ADD CdEmpresa     int NULL;
-- ALTER TABLE CONFIRMAFACILOCORRENCIA ADD NrSeqControle bigint NULL;
-- ALTER TABLE CONFIRMAFACILOCORRENCIA ADD CdSequencia   int NULL;
-- ALTER TABLE CONFIRMAFACILOCORRENCIA ADD VER_ID INT NOT NULL DEFAULT 1 ; 08/10/2021


